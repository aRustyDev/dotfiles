services:
  qdrant:
    image: qdrant/qdrant
    hostname: qdrant
    container_name: qdrant
    profiles: ["core", "n8n"]
    stdin_open: true # docker run -i
    tty: true # docker run -t
    networks:
      - n8n
      - traefik-public
    restart: unless-stopped
    expose:
      - "6333"
    volumes:
      - ${XDG_DATA_HOME:-$HOME/.local/share}/mcp/qdrant:/qdrant/storage
    labels:
      # =======================================================================
      # Traefik Configuration - Qdrant Vector Database
      # =======================================================================
      # NOTE: Routing is defined in file provider (svc.db.qdrant.yaml)
      # because parentRefs (multi-layer routing) is not supported in Docker labels.
      #
      # Endpoints:
      #   - REST API: port 6333 (via db@file -> qdrant)
      #   - gRPC: port 6334 (direct, not via Traefik)
      # =======================================================================
      traefik.enable: true
      traefik.docker.network: traefik-public
